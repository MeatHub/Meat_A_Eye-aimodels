# ğŸ¥© Meat-A-Eye AI Models

> EfficientNet-B2 ê¸°ë°˜ ê³ ê¸° ë¶€ìœ„ ìë™ ë¶„ë¥˜ AI ì—”ì§„ â€” ì†Œê³ ê¸° 9ë¶€ìœ„ / ë¼ì§€ê³ ê¸° 7ë¶€ìœ„ ì‹¤ì‹œê°„ íŒë³„ ë° Grad-CAM ì‹œê°í™”

## ğŸ“‹ ëª©ì°¨

- [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
- [ëª¨ë¸ ì•„í‚¤í…ì²˜](#ëª¨ë¸-ì•„í‚¤í…ì²˜)
- [ë¶„ë¥˜ í´ë˜ìŠ¤](#ë¶„ë¥˜-í´ë˜ìŠ¤)
- [í•™ìŠµ ì „ëµ](#í•™ìŠµ-ì „ëµ)
- [ë°ì´í„° íŒŒì´í”„ë¼ì¸](#ë°ì´í„°-íŒŒì´í”„ë¼ì¸)
- [API ì„œë²„](#api-ì„œë²„)
- [OCR ì—”ì§„](#ocr-ì—”ì§„)
- [í”„ë¡œì íŠ¸ êµ¬ì¡°](#í”„ë¡œì íŠ¸-êµ¬ì¡°)
- [ì‹¤í–‰ ë°©ë²•](#ì‹¤í–‰-ë°©ë²•)
- [ì„±ëŠ¥ ì§€í‘œ](#ì„±ëŠ¥-ì§€í‘œ)

---

## í”„ë¡œì íŠ¸ ê°œìš”

Meat-A-Eye AI ì„œë²„ëŠ” ì´¬ì˜ëœ ê³ ê¸° ì´ë¯¸ì§€ë¥¼ ì…ë ¥ë°›ì•„ **ì†Œê³ ê¸° 9ê°œ ë¶€ìœ„** ë˜ëŠ” **ë¼ì§€ê³ ê¸° 7ê°œ ë¶€ìœ„**ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¶„ë¥˜í•˜ê³ , **Grad-CAM íˆíŠ¸ë§µ**ì„ í†µí•´ ëª¨ë¸ì´ ì–´ë–¤ ì‹œê°ì  íŠ¹ì§•(ì§ˆê°, ê²°, ë§ˆë¸”ë§ ë“±)ì— ì£¼ëª©í–ˆëŠ”ì§€ ì‹œê°í™”í•©ë‹ˆë‹¤.

í˜„ì‹¤ í™˜ê²½(ê·¸ë¦¼ì, ì¡°ëª… ë³€í™”, ë°°ê²½)ì—ì„œì˜ ê°•ê±´í•œ ì¸ì‹ì„ ëª©í‘œë¡œ, ìœ íŠœë¸ŒÂ·í˜„ì¥ ì´ë¯¸ì§€ë¥¼ í™œìš©í•œ ë°ì´í„° ìˆ˜ì§‘ê³¼ 4ì°¨ì— ê±¸ì¹œ ì ì§„ì  íŒŒì¸íŠœë‹ìœ¼ë¡œ ìµœì¢… **ì†Œê³ ê¸° 90.0%, ë¼ì§€ê³ ê¸° 94.2%** ì •í™•ë„ë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤.

---

## ëª¨ë¸ ì•„í‚¤í…ì²˜

### EfficientNet-B2 ì„ íƒ ê·¼ê±°

EfficientNetì€ **Compound Scaling**ì„ í†µí•´ ë„¤íŠ¸ì›Œí¬ì˜ ê¹Šì´(Depth), ë„ˆë¹„(Width), í•´ìƒë„(Resolution)ë¥¼ ë™ì‹œì— ìµœì  ë¹„ìœ¨ë¡œ í™•ì¥í•˜ëŠ” ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤. B2ëŠ” ì„±ëŠ¥ê³¼ ì¶”ë¡  ì†ë„ì˜ ê· í˜•ì ìœ¼ë¡œ, ì‹¤ì‹œê°„ ì„œë¹„ìŠ¤ì— ì í•©í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EfficientNet-B2 Architecture                                   â”‚
â”‚                                                                 â”‚
â”‚  Input (260Ã—260Ã—3)                                              â”‚
â”‚    â†“                                                            â”‚
â”‚  Stem Conv (3Ã—3, stride 2)                                      â”‚
â”‚    â†“                                                            â”‚
â”‚  MBConv Block Ã—16 (7 stages)                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Depthwise Separable Convolution              â”‚              â”‚
â”‚  â”‚    â†’ ì—°ì‚°ëŸ‰ ì ˆê° (ì¼ë°˜ Conv ëŒ€ë¹„ 1/kÂ² ìˆ˜ì¤€)       â”‚             â”‚
â”‚  â”‚  Squeeze-and-Excitation (SE) Block            â”‚              â”‚
â”‚  â”‚    â†’ ì±„ë„ë³„ ì¤‘ìš”ë„ ì¬ê°€ì¤‘ (ì§ˆê°Â·ë§ˆë¸”ë§ ê°•ì¡°)       â”‚              â”‚
â”‚  â”‚  Skip Connection (Residual)                   â”‚              â”‚
â”‚  â”‚    â†’ ê¹Šì€ ë„¤íŠ¸ì›Œí¬ì—ì„œë„ ê·¸ë˜ë””ì–¸íŠ¸ ì•ˆì • ì „íŒŒ       â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚    â†“                                                            â”‚
â”‚  Head Conv (1Ã—1) â†’ Global Average Pooling                       â”‚
â”‚    â†“                                                            â”‚
â”‚  Custom Classifier                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚  Dropout(p=0.4)                   â”‚                          â”‚
â”‚  â”‚  Linear(1408 â†’ num_classes)       â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚    â†“                                                            â”‚
â”‚  Output: Softmax Probabilities                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í•µì‹¬ êµ¬ì„± ìš”ì†Œ

| êµ¬ì„± ìš”ì†Œ | ì—­í•  | ê³ ê¸° ë¶„ë¥˜ì—ì„œì˜ ì˜ë¯¸ |
|-----------|------|---------------------|
| **MBConv (Mobile Inverted Bottleneck)** | Depthwise Separable Convë¡œ ê³µê°„ íŠ¹ì§• ì¶”ì¶œ | ê³ ê¸°ì˜ ê²° ë°©í–¥, ì§€ë°© ë¶„í¬ íŒ¨í„´ í•™ìŠµ |
| **SE Block (Squeeze-and-Excitation)** | ì±„ë„ë³„ attentionìœ¼ë¡œ ì¤‘ìš” íŠ¹ì§• ê°•ì¡° | ë§ˆë¸”ë§Â·ìƒ‰ìƒ ì±„ë„ì— ë†’ì€ ê°€ì¤‘ì¹˜ â†’ ë¶€ìœ„ë³„ ì§ˆê° ì°¨ì´ í¬ì°© |
| **Compound Scaling** | depthÂ·widthÂ·resolution ë™ì‹œ ìµœì í™” | 260Ã—260 í•´ìƒë„ì—ì„œ ì„¸ë°€í•œ ì§ˆê° êµ¬ë¶„ ê°€ëŠ¥ |
| **Skip Connection** | ì”ì°¨ ì—°ê²°ë¡œ í•™ìŠµ ì•ˆì •ì„± í™•ë³´ | íŒŒì¸íŠœë‹ ì‹œ ê¸°ì¡´ íŠ¹ì§• ë³´ì¡´ì— ê¸°ì—¬ |

### Grad-CAM ì‹œê°í™”

ëª¨ë¸ì˜ ë§ˆì§€ë§‰ í•©ì„±ê³± ë ˆì´ì–´(`model.features[-1]`)ì— ê·¸ë˜ë””ì–¸íŠ¸ ê¸°ë°˜ Class Activation Mapì„ ìƒì„±í•˜ì—¬, ê° ì˜ˆì¸¡ì—ì„œ ëª¨ë¸ì´ **ì–´ë””ë¥¼ ë³´ê³  íŒë‹¨í–ˆëŠ”ì§€** íˆíŠ¸ë§µìœ¼ë¡œ ì‹œê°í™”í•©ë‹ˆë‹¤.

```python
# Grad-CAM í•µì‹¬ ë¡œì§
gradients = hook_backward(target_class)         # í´ë˜ìŠ¤ë³„ ê·¸ë˜ë””ì–¸íŠ¸
weights = global_average_pool(gradients)         # ì±„ë„ë³„ ì¤‘ìš”ë„
cam = ReLU(Î£ weights Ã— feature_maps)            # ê°€ì¤‘í•© â†’ í™œì„±í™”
heatmap = normalize(cam) â†’ JET colormap         # 0~255 ì»¬ëŸ¬ë§µ
overlay = 0.55 Ã— original + 0.45 Ã— heatmap      # ì›ë³¸ê³¼ í•©ì„±
```

---

## ë¶„ë¥˜ í´ë˜ìŠ¤

### ì†Œê³ ê¸° 9ë¶€ìœ„

| Index | ì˜ë¬¸ í´ë˜ìŠ¤ëª… | í•œêµ­ì–´ ë¶€ìœ„ëª… |
|-------|-------------|-------------|
| 0 | `Beef_Brisket` | ì–‘ì§€ |
| 1 | `Beef_Chuck` | ëª©ì‹¬ |
| 2 | `Beef_Rib` | ê°ˆë¹„ |
| 3 | `Beef_Ribeye` | ë“±ì‹¬ |
| 4 | `Beef_Round` | ìš°ë‘” |
| 5 | `Beef_Shank` | ì‚¬íƒœ |
| 6 | `Beef_Shoulder` | ì•ë‹¤ë¦¬ |
| 7 | `Beef_Sirloin` | ì±„ë |
| 8 | `Beef_Tenderloin` | ì•ˆì‹¬ |

> **ì°¸ê³ :** `Beef_BottomRound`ëŠ” 4ì°¨ í•™ìŠµì—ì„œ `Beef_Round`ë¡œ ë³‘í•© (ì‹œê°ì  ìœ ì‚¬ì„±ì— ì˜í•œ í´ë˜ìŠ¤ ìµœì í™”)

### ë¼ì§€ê³ ê¸° 7ë¶€ìœ„

| Index | ì˜ë¬¸ í´ë˜ìŠ¤ëª… | í•œêµ­ì–´ ë¶€ìœ„ëª… |
|-------|-------------|-------------|
| 0 | `Pork_Belly` | ì‚¼ê²¹ì‚´ |
| 1 | `Pork_Ham` | ë’·ë‹¤ë¦¬ |
| 2 | `Pork_Loin` | ë“±ì‹¬ |
| 3 | `Pork_Neck` | ëª©ì‚´ |
| 4 | `Pork_PicnicShoulder` | ì•ë‹¤ë¦¬ |
| 5 | `Pork_Ribs` | ê°ˆë¹„ |
| 6 | `Pork_Tenderloin` | ì•ˆì‹¬ |

---

## í•™ìŠµ ì „ëµ

### ì ì§„ì  íŒŒì¸íŠœë‹ (Progressive Fine-tuning)

ê¸°ì¡´ í•™ìŠµëœ ê°€ì¤‘ì¹˜ë¥¼ ë³´ì¡´í•˜ë©´ì„œ ìƒˆ ë°ì´í„°ë¥¼ í•™ìŠµí•˜ëŠ” ì „ëµì…ë‹ˆë‹¤. **Catastrophic Forgetting**ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ê¸°ë²•ë“¤ì„ ì¡°í•©í•©ë‹ˆë‹¤.

#### 1. ì°¨ë³„ì  í•™ìŠµë¥  (Differential Learning Rate)

```python
optimizer = AdamW([
    {"params": backbone_params, "lr": 1e-4},   # ê¸°ì¡´ íŠ¹ì§• ì¶”ì¶œê¸°: ë¯¸ì„¸ ì¡°ì •
    {"params": head_params,     "lr": 1e-3},   # ìƒˆ ë¶„ë¥˜ê¸°: ë¹ ë¥¸ í•™ìŠµ
], weight_decay=1e-2)
```

- **Backbone (1e-4):** ImageNetì—ì„œ í•™ìŠµëœ ë²”ìš© ì‹œê° íŠ¹ì§•ì„ ê±°ì˜ ìœ ì§€í•˜ë©´ì„œ ê³ ê¸° ë„ë©”ì¸ì— ë¯¸ì„¸ ì ì‘
- **Classification Head (1e-3):** ìƒˆë¡œ ì´ˆê¸°í™”ëœ ë¶„ë¥˜ê¸°ëŠ” 10ë°° ë¹ ë¥¸ ì†ë„ë¡œ ë¶€ìœ„ë³„ íŠ¹ì§• í•™ìŠµ

#### 2. Warmup + Cosine Annealing ìŠ¤ì¼€ì¤„ëŸ¬

```
LR
â”‚  â•±â€¾â€¾â€¾â€¾â€¾â€¾â•²
â”‚ â•±        â•²          â•±â€¾â€¾â•²
â”‚â•±          â•²        â•±    â•²        â•±â€¾â•²
â”‚            â•²      â•±      â•²      â•±   â•²
â”‚             â•²    â•±        â•²    â•±     â•²
â”‚              â•²  â•±          â•²  â•±       â•²
â”‚               â•²â•±            â•²â•±         â•²â†’
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Epoch
â”‚â† Warmup â†’â”‚â† Cosine Annealing with Warm Restarts â†’â”‚
   (3 epochs)
   1e-6 â†’ 1e-4
```

- **Warmup (3 epochs):** LRì„ 1e-6ì—ì„œ ì‹œì‘í•˜ì—¬ ì ì§„ì ìœ¼ë¡œ ì¦ê°€ â†’ í•™ìŠµ ì´ˆê¸° ë¶ˆì•ˆì •ì„± ë°©ì§€
- **Cosine Annealing:** ì£¼ê¸°ì ìœ¼ë¡œ LRì„ ì˜¬ë ¸ë‹¤ ë‚´ë¦¬ë©´ì„œ local minima íƒˆì¶œ

#### 3. ë°ì´í„° ì¦ê°• (Albumentations)

| ì¦ê°• ê¸°ë²• | íŒŒë¼ë¯¸í„° | ëª©ì  |
|-----------|---------|------|
| `Affine` | translate 10%, scale 0.8~1.2, rotate Â±30Â° | ë‹¤ì–‘í•œ ì´¬ì˜ ê°ë„ ëŒ€ì‘ |
| `HorizontalFlip` | p=0.5 | ì¢Œìš° ëŒ€ì¹­ ë¶ˆë³€ì„± |
| `VerticalFlip` | p=0.3 | ìƒí•˜ ë°°ì¹˜ ë³€í™” ëŒ€ì‘ |
| `RandomBrightnessContrast` | - | ì¡°ëª… ë³€í™” ëŒ€ì‘ |
| `HueSaturationValue` | - | ìƒ‰ì˜¨ë„Â·í¬í™”ë„ ë³€í™” ëŒ€ì‘ |
| `CLAHE` | - | ì €ì¡°ë„ í™˜ê²½ ëŒ€ë¹„ ê°•í™” |
| `GaussNoise` | - | ì¹´ë©”ë¼ ë…¸ì´ì¦ˆ ê°•ê±´ì„± |
| `GaussianBlur` | - | ì´ˆì  íë¦¼ ëŒ€ì‘ |
| `CoarseDropout` | - | Cutout íš¨ê³¼ë¡œ ê³¼ì í•© ë°©ì§€ |

#### 4. í´ë˜ìŠ¤ ë¶ˆê· í˜• ì²˜ë¦¬

```python
# WeightedRandomSampler: ì†Œìˆ˜ í´ë˜ìŠ¤ ê³¼í‘œì§‘
class_counts = [len(os.listdir(class_dir)) for class_dir in classes]
weights = 1.0 / torch.tensor(class_counts, dtype=torch.float)
sample_weights = weights[labels]
sampler = WeightedRandomSampler(sample_weights, len(sample_weights))
```

#### 5. ì¶”ê°€ ì •ê·œí™”

| ê¸°ë²• | ì„¤ì • | íš¨ê³¼ |
|------|------|------|
| **Label Smoothing** | Îµ = 0.1 | ê³¼ë„í•œ í™•ì‹  ë°©ì§€, ì¼ë°˜í™” í–¥ìƒ |
| **Mixup** | Î± = 0.2 | ë‘ ì´ë¯¸ì§€/ë¼ë²¨ í˜¼í•©ìœ¼ë¡œ ê²°ì • ê²½ê³„ ë¶€ë“œëŸ½ê²Œ |
| **Gradient Clipping** | max_norm = 1.0 | ê·¸ë˜ë””ì–¸íŠ¸ í­ë°œ ë°©ì§€ |
| **Dropout** | p = 0.4 | ë¶„ë¥˜ê¸° ê³¼ì í•© ì–µì œ |
| **Early Stopping** | patience = 10 | ê²€ì¦ ì†ì‹¤ ì •ì²´ ì‹œ í•™ìŠµ ì¤‘ë‹¨ |

#### 6. TTA (Test Time Augmentation)

ì¶”ë¡  ì‹œ 5ê°€ì§€ ë³€í™˜ì„ ì ìš©í•œ ì˜ˆì¸¡ì„ Softmax ì•™ìƒë¸”í•˜ì—¬ ì•ˆì •ì  ê²°ê³¼ ë„ì¶œ

---

## ë°ì´í„° íŒŒì´í”„ë¼ì¸

### ìˆ˜ì§‘ â†’ ì •ì œ â†’ ë¶„í•  íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë°ì´í„° ìˆ˜ì§‘   â”‚ â†’ â”‚ 1ì°¨ ìë™ ì •ì œ  â”‚ â†’ â”‚ 2ì°¨ ìˆ˜ë™ ì •ì œ  â”‚ â†’ â”‚ ê· ë“± ë¶„í•     â”‚
â”‚             â”‚    â”‚              â”‚    â”‚              â”‚    â”‚            â”‚
â”‚ â€¢ ì—°êµ¬ìš© DB  â”‚    â”‚ â€¢ í˜•ì‹ í•„í„°   â”‚    â”‚ â€¢ ì˜¤ë¶„ë¥˜ ì œê±°  â”‚    â”‚ â€¢ 100ì¥/ë¶€ìœ„â”‚
â”‚ â€¢ ìœ íŠœë¸Œ ìº¡ì²˜ â”‚    â”‚ â€¢ í¬ê¸° í•„í„°   â”‚    â”‚ â€¢ í’ˆì§ˆ ê²€ìˆ˜   â”‚    â”‚ â€¢ 70/15/15 â”‚
â”‚ â€¢ í˜„ì¥ ì´¬ì˜   â”‚    â”‚ â€¢ ì¤‘ë³µ ì œê±°   â”‚    â”‚ â€¢ ê²½ê³„ ì¼€ì´ìŠ¤  â”‚    â”‚ â€¢ seed=42  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Dataset Balancer

ë¶€ìœ„ë³„ í•™ìŠµ ë°ì´í„° ë¶ˆê· í˜•ì„ í•´ê²°í•˜ê¸° ìœ„í•œ CLI ë„êµ¬:

```bash
# ì†Œê³ ê¸°: ë¶€ìœ„ë³„ 100ì¥ì”© ê· ë“± ë¶„í• 
python dataset_balancer.py split --samples 100

# ë¼ì§€ê³ ê¸°: ë¶€ìœ„ë³„ 50ì¥ì”© ê· ë“± ë¶„í• 
python pork_dataset_balancer.py split --samples 50

# ë¶„í•  ê²°ê³¼:  train 70ì¥ / val 15ì¥ / test 15ì¥ (per class)
```

### ë°ì´í„°ì…‹ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
data/
â”œâ”€â”€ raw_dataset/          # ì •ì œ ì „ ì›ë³¸
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ Beef_Brisket/
â”‚   â”‚   â”œâ”€â”€ Beef_Chuck/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ test/
â”œâ”€â”€ train_dataset_v3/     # 3ì°¨ í•™ìŠµ ë°ì´í„°
â”‚   â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ val/
â”‚   â””â”€â”€ test/
â””â”€â”€ train_dataset_v4/     # 4ì°¨ í•™ìŠµ ë°ì´í„° (ìµœì¢…)
    â”œâ”€â”€ train/
    â”œâ”€â”€ val/
    â””â”€â”€ test/
```

---

## API ì„œë²„

### FastAPI ì—”ë“œí¬ì¸íŠ¸ (Port: 8001)

| Method | Endpoint | ê¸°ëŠ¥ | ì…ë ¥ | ì¶œë ¥ |
|--------|----------|------|------|------|
| `GET` | `/` | Health Check | - | `{"status": "running"}` |
| `POST` | `/predict` | ì†Œê³ ê¸° ë¶„ë¥˜ (Legacy) | `image: UploadFile` | `class_name`, `confidence`, `heatmap_image` |
| `POST` | `/ai/analyze` | í†µí•© ë¶„ì„ | `image: UploadFile`, `mode: str` | ë¶„ë¥˜ ê²°ê³¼ + Grad-CAM íˆíŠ¸ë§µ |

### ë¶„ì„ ëª¨ë“œ (`/ai/analyze`)

| ëª¨ë“œ | ì„¤ëª… | ëª¨ë¸ |
|------|------|------|
| `beef` | ì†Œê³ ê¸° 9ë¶€ìœ„ ë¶„ë¥˜ + Grad-CAM | `b2_imagenet_beef_100-v4.pth` |
| `pork` | ë¼ì§€ê³ ê¸° 7ë¶€ìœ„ ë¶„ë¥˜ + Grad-CAM | `b2_imagenet_pork_50-v4.pth` |
| `ocr` | ì¶•ì‚°ë¬¼ ì´ë ¥ë²ˆí˜¸ OCR ì¶”ì¶œ | EasyOCR (í•œ/ì˜) |

### ì‘ë‹µ í˜•ì‹

```json
{
  "status": "success",
  "message": "Success",
  "data": {
    "class_name": "Beef_Ribeye",
    "confidence": 0.9523,
    "heatmap_image": "base64_encoded_jpeg..."
  }
}
```

### ì—ëŸ¬ ì½”ë“œ

| ì½”ë“œ | ì˜ë¯¸ |
|------|------|
| `LOW_CONFIDENCE` | ì‹ ë¢°ë„ 75% ë¯¸ë§Œ |
| `INVALID_IMAGE` | ì´ë¯¸ì§€ í˜•ì‹ ì˜¤ë¥˜ |
| `NOT_MEAT` | ê³ ê¸°ë¡œ ì¸ì‹ ë¶ˆê°€ |
| `OCR_FAILED` | ì´ë ¥ë²ˆí˜¸ ì¶”ì¶œ ì‹¤íŒ¨ |
| `SERVER_ERROR` | ë‚´ë¶€ ì„œë²„ ì˜¤ë¥˜ |

---

## OCR ì—”ì§„

ì¶•ì‚°ë¬¼ ì´ë ¥ë²ˆí˜¸ ë¼ë²¨ì—ì„œ ì´ë ¥ë²ˆí˜¸ë¥¼ ìë™ ì¶”ì¶œí•˜ëŠ” ì—”ì§„ì…ë‹ˆë‹¤.

### ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸

```
ì…ë ¥ ì´ë¯¸ì§€
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì•™ìƒë¸” ì „ì²˜ë¦¬ (2ê°œ íŒŒì´í”„ë¼ì¸)     â”‚
â”‚                                 â”‚
â”‚ Pipeline A: Bilateral Filter    â”‚
â”‚   2Ã— ì—…ìŠ¤ì¼€ì¼ â†’ ê·¸ë ˆì´ìŠ¤ì¼€ì¼ â†’    â”‚
â”‚   ì–‘ë°©í–¥ í•„í„° (ë…¸ì´ì¦ˆ ì œê±°)        â”‚
â”‚                                 â”‚
â”‚ Pipeline B: Adaptive Threshold  â”‚
â”‚   2Ã— ì—…ìŠ¤ì¼€ì¼ â†’ ê·¸ë ˆì´ìŠ¤ì¼€ì¼ â†’    â”‚
â”‚   ê°€ìš°ì‹œì•ˆ ì ì‘ ì´ì§„í™”             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
EasyOCR (í•œêµ­ì–´ + ì˜ì–´)
    â†“
í…ìŠ¤íŠ¸ í›„ì²˜ë¦¬ (ë°•ìŠ¤ ë³‘í•© â†’ ì •ì œ â†’ ì•µì»¤ ê¸°ë°˜ ìŠ¤ì½”ì–´ë§)
    â†“
ì´ë ¥ë²ˆí˜¸ íŒ¨í„´ ë§¤ì¹­
```

### ì¸ì‹ íŒ¨í„´

| íŒ¨í„´ | í˜•ì‹ | ì„¤ëª… |
|------|------|------|
| `^\d{12}$` | 12ìë¦¬ ìˆ«ì | êµ­ë‚´ì‚°/ìˆ˜ì… ê¸°ë³¸ ì´ë ¥ë²ˆí˜¸ |
| `^L\d{14}$` | L + 14ìë¦¬ | êµ­ë‚´ì‚° ë¬¶ìŒë²ˆí˜¸ |
| `^A\d{19,29}$` | A + 19~29ìë¦¬ | ìˆ˜ì…/ë°°ì¹˜ ë²ˆí˜¸ |

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
Meat_A_Eye-aimodels/
â”œâ”€â”€ README.md                          # ë³¸ ë¬¸ì„œ
â”œâ”€â”€ requirements.txt                   # ì˜ì¡´ì„± íŒ¨í‚¤ì§€
â”‚
â”œâ”€â”€ ai-server/
â”‚   â”œâ”€â”€ main.py                        # FastAPI ì„œë²„ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”‚   â”œâ”€â”€ predict_b2.py                  # ì†Œê³ ê¸° ì¶”ë¡  ì—”ì§„ (Singleton + Grad-CAM)
â”‚   â”œâ”€â”€ predict_pork.py                # ë¼ì§€ê³ ê¸° ì¶”ë¡  ì—”ì§„ (Singleton + Grad-CAM)
â”‚   â”œâ”€â”€ vision_engine.py               # Legacy í˜¸í™˜ ë˜í¼
â”‚   â”œâ”€â”€ ocr_engine.py                  # ì¶•ì‚°ë¬¼ ì´ë ¥ë²ˆí˜¸ OCR (EasyOCR)
â”‚   â”œâ”€â”€ web_processor.py               # ì´ë¯¸ì§€ ë°”ì´íŠ¸ â†’ RGB ë°°ì—´ ë³€í™˜
â”‚   â”‚
â”‚   â”œâ”€â”€ finetune.py                    # ì†Œê³ ê¸° ëª¨ë¸ íŒŒì¸íŠœë‹ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ train.py                       # ë¼ì§€ê³ ê¸° ëª¨ë¸ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ dataset_balancer.py            # ì†Œê³ ê¸° ë°ì´í„°ì…‹ ê· ë“± ë¶„í•  ë„êµ¬
â”‚   â”œâ”€â”€ pork_dataset_balancer.py       # ë¼ì§€ê³ ê¸° ë°ì´í„°ì…‹ ê· ë“± ë¶„í•  ë„êµ¬
â”‚   â”‚
â”‚   â”œâ”€â”€ test_all.py                    # ì†Œê³ ê¸° ì „ì²´ ë°ì´í„°ì…‹ êµì°¨ í‰ê°€
â”‚   â”œâ”€â”€ test_visualize.py              # ì†Œê³ ê¸° ë‹¨ì¼ ë°ì´í„°ì…‹ ì‹œê°í™” í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ pork_test_all.py               # ë¼ì§€ê³ ê¸° ì „ì²´ ë°ì´í„°ì…‹ êµì°¨ í‰ê°€
â”‚   â”œâ”€â”€ pork_test_visualize.py         # ë¼ì§€ê³ ê¸° ë‹¨ì¼ ë°ì´í„°ì…‹ ì‹œê°í™” í…ŒìŠ¤íŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ b2_imagenet_beef_100-v4.pth    # ì†Œê³ ê¸° ìµœì¢… ëª¨ë¸ (9ë¶€ìœ„)
â”‚   â”‚   â””â”€â”€ b2_imagenet_pork_50-v4.pth     # ë¼ì§€ê³ ê¸° ìµœì¢… ëª¨ë¸ (7ë¶€ìœ„)
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ logger.py                  # ë¡œê¹… ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â””â”€â”€ response.py               # í‘œì¤€ API ì‘ë‹µ í¬ë§·
â”‚   â”‚
â”‚   â”œâ”€â”€ convnext_l/                    # ConvNeXt-L ì‹¤í—˜ (ë¹„êµêµ°)
â”‚   â”œâ”€â”€ efficientnetv2_l/              # EfficientNetV2-L ì‹¤í—˜ (ë¹„êµêµ°)
â”‚   â””â”€â”€ swin_transformer/             # Swin Transformer ì‹¤í—˜ (ë¹„êµêµ°)
â”‚
â””â”€â”€ data/
    â”œâ”€â”€ train_dataset_v3/              # 3ì°¨ ë°ì´í„°ì…‹
    â””â”€â”€ train_dataset_v4/              # 4ì°¨ ë°ì´í„°ì…‹ (ìµœì¢…)
```

---

## ì‹¤í–‰ ë°©ë²•

### í™˜ê²½ ì„¤ì •

```bash
# CUDA 12.6 í™˜ê²½ í•„ìˆ˜
pip install -r requirements.txt

# PyTorch CUDA í™•ì¸
python -c "import torch; print(torch.cuda.is_available())"
```

### AI ì„œë²„ ì‹¤í–‰

```bash
cd ai-server
python main.py
# â†’ http://0.0.0.0:8001 ì—ì„œ ì„œë²„ ì‹œì‘
```

### ëª¨ë¸ í•™ìŠµ

```bash
# ê³ ê¸° íŒŒì¸íŠœë‹
python finetune.py

# ê³ ê¸° í•™ìŠµ
python train.py

# í…ŒìŠ¤íŠ¸ í‰ê°€
python test_all.py          # ì†Œê³ ê¸° ì „ì²´ í‰ê°€
python pork_test_all.py     # ë¼ì§€ê³ ê¸° ì „ì²´ í‰ê°€
```

---

## ì„±ëŠ¥ ì§€í‘œ

### ìµœì¢… (4ì°¨ íŒŒì¸íŠœë‹) ê²°ê³¼

| ëª¨ë¸ | ë¶„ë¥˜ ëŒ€ìƒ | ì •í™•ë„ | í´ë˜ìŠ¤ ìˆ˜ | ë¶€ìœ„ë‹¹ í•™ìŠµ ë°ì´í„° |
|------|-----------|--------|-----------|------------------|
| **Beef v4** | ì†Œê³ ê¸° | **90.0%** | 9ë¶€ìœ„ | 100ì¥ (70/15/15) |
| **Pork v4** | ë¼ì§€ê³ ê¸° | **94.2%** | 7ë¶€ìœ„ | 50ì¥ (35/8/7) |

### ì„±ëŠ¥ ë³€í™” ì¶”ì´

```
Accuracy
100% â”‚
 95% â”‚                                    â— 94.2% (ë¼ì§€)
 90% â”‚                         â— 90.0% (ì†Œ)
 85% â”‚              â—
 80% â”‚        â—
 75% â”‚
 70% â”‚  â—
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
       1ì°¨    2ì°¨    3ì°¨    4ì°¨
```

---

## ê¸°ìˆ  ìŠ¤íƒ

| ì˜ì—­ | ê¸°ìˆ  |
|------|------|
| **Deep Learning** | PyTorch 2.6.0 (CUDA 12.6), torchvision |
| **Model** | EfficientNet-B2 (ImageNet pretrained) |
| **Augmentation** | Albumentations 2.0.8 |
| **OCR** | EasyOCR 1.7.2 (í•œêµ­ì–´ + ì˜ì–´) |
| **Web Server** | FastAPI 0.128.2, Uvicorn |
| **Visualization** | Matplotlib, Seaborn, OpenCV |
| **Evaluation** | scikit-learn (Confusion Matrix, per-class metrics) |
